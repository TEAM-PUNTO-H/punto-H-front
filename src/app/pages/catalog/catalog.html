<div class="catalog-page">
  <header class="catalog-header">
    <div class="container">
      <!-- Barra de bÃºsqueda sola en su layer -->
      <div class="search-container">
        <div class="search-wrapper">
          <span class="search-icon">ğŸ”</span>
          <input 
            placeholder="Buscar restaurantes o platos..." 
            [(ngModel)]="searchTerm" 
            (ngModelChange)="applyAll()" 
            class="search-input"/>
        </div>
      </div>
    </div>
  </header>

  <div class="container main">
    <!-- Controles de ordenamiento y filtros -->
    <div class="controls-section">
      <div class="controls-row">
        <select [(ngModel)]="orden" (change)="applyAll()" class="select-orden">
          <option value="recomendados">ğŸ“Œ Recomendados</option>
          <option value="calificacion">â­ Mayor CalificaciÃ³n</option>
          <option value="rapido">âš¡ MÃ¡s RÃ¡pido</option>
          <option value="barato">ğŸ’° MÃ¡s Barato</option>
        </select>

        <button class="btn-filtros-avanzados" (click)="showAdvancedFilters = !showAdvancedFilters">
          <span class="filter-icon">{{ showAdvancedFilters ? 'ğŸ”½' : 'âš™ï¸' }}</span>
          Filtros Avanzados
        </button>
      </div>

      <!-- Filtros rÃ¡pidos horizontales -->
      <div class="filtros-rapidos-row">
        <button (click)="toggleFiltroRapido('abierto')" [class.active]="filtrosRapidos.abierto" class="filtro-rapido-btn">
          ğŸŸ¢ Solo Abiertos
        </button>
        <button (click)="toggleFiltroRapido('delivery')" [class.active]="filtrosRapidos.delivery" class="filtro-rapido-btn">
          ğŸšš Delivery Gratis
        </button>
        <button (click)="toggleFiltroRapido('nuevo')" [class.active]="filtrosRapidos.nuevo" class="filtro-rapido-btn">
          âœ¨ Nuevos
        </button>
      </div>

      <!-- Filtros avanzados (colapsable) -->
      <div class="filtros-avanzados-container" *ngIf="showAdvancedFilters">
        <div class="filtros-avanzados-content">
          <div class="filter-group">
            <h4>Tipo de Cocina</h4>
            <div class="tipo-list">
              <label><input type="checkbox" (change)="toggleFiltroTipo('mexicana')"/> Mexicana</label>
              <label><input type="checkbox" (change)="toggleFiltroTipo('vegetariana')"/> Vegetariana</label>
              <label><input type="checkbox" (change)="toggleFiltroTipo('cafeteria')"/> CafeterÃ­a</label>
              <label><input type="checkbox" (change)="toggleFiltroTipo('rapida')"/> Comida RÃ¡pida</label>
              <label><input type="checkbox" (change)="toggleFiltroTipo('japonesa')"/> Japonesa</label>
            </div>
          </div>

          <div class="filter-group">
            <h4>Rango de precios</h4>
            <div class="radio-list">
              <label><input type="radio" name="precio" value="todos" [checked]="precio === 'todos'" (change)="setPrecio('todos')"/> Todos</label>
              <label><input type="radio" name="precio" value="bajo" [checked]="precio === 'bajo'" (change)="setPrecio('bajo')"/> $</label>
              <label><input type="radio" name="precio" value="medio" [checked]="precio === 'medio'" (change)="setPrecio('medio')"/> $$</label>
              <label><input type="radio" name="precio" value="alto" [checked]="precio === 'alto'" (change)="setPrecio('alto')"/> $$$</label>
            </div>
          </div>

          <div class="filter-group">
            <h4>CalificaciÃ³n mÃ­nima</h4>
            <div class="radio-list">
              <label><input type="radio" name="cal" value="0" [checked]="calificacion === 0" (change)="setCalificacion(0)"/> Todas</label>
              <label><input type="radio" name="cal" value="4" [checked]="calificacion === 4" (change)="setCalificacion(4)"/> â­ 4.0+</label>
              <label><input type="radio" name="cal" value="4.5" [checked]="calificacion === 4.5" (change)="setCalificacion(4.5)"/> â­ 4.5+</label>
            </div>
          </div>

          <div class="filter-group">
            <h4>Tiempo mÃ¡ximo (min)</h4>
            <div class="radio-list">
              <label><input type="radio" name="t" value="0" [checked]="tiempo === 0" (change)="setTiempo(0)"/> Cualquiera</label>
              <label><input type="radio" name="t" value="15" [checked]="tiempo === 15" (change)="setTiempo(15)"/> 15</label>
              <label><input type="radio" name="t" value="30" [checked]="tiempo === 30" (change)="setTiempo(30)"/> 30</label>
            </div>
          </div>

          <div class="filter-group">
            <label><input type="checkbox" [checked]="soloPromociones" (change)="togglePromociones()"/> ğŸ Solo promociones</label>
          </div>

          <div class="filter-group">
            <button class="btn" (click)="limpiarFiltros()">Limpiar filtros</button>
          </div>
        </div>
      </div>
    </div>

    <!-- grid -->
    <main class="grid-area">
      <div *ngIf="restaurants.length===0" class="no-results">
        <h3>ğŸ” No se encontraron resultados</h3>
        <p>Intenta ajustar tus filtros o buscar con otros tÃ©rminos</p>
        <button class="btn" (click)="limpiarFiltros()">Limpiar filtros</button>
      </div>

      <div class="grid">
        <app-restaurant-card *ngFor="let r of restaurants"
          [restaurant]="r"
          (openRestaurant)="openRestaurant($event)"
          (addDish)="agregarAlCarritoMsg($event)">
        </app-restaurant-card>
      </div>
    </main>
  </div>

  <!-- notification -->
  <div class="notification" [class.show]="showNotificationFlag">{{ notificationText }}</div>

  <!-- modals -->
  <app-restaurant-detail *ngIf="showRestaurantDetail" [restaurant]="selectedRestaurant" (close)="closeRestaurant()" (openDish)="openDish($event.rest,$event.dish)"></app-restaurant-detail>

  <app-dish-detail *ngIf="showDishDetail" [dish]="selectedDish" [restaurant]="selectedDishRestaurant" (close)="closeDish()" (add)="agregarAlCarritoMsg($event)"></app-dish-detail>
</div>
