<div class="card" (click)="open()">
  <div class="card-header" [style.background]="headerColor()">
    <div class="restaurant-image-container">
      <img 
        *ngIf="getRestaurantImage()" 
        [src]="getRestaurantImage()" 
        [alt]="restaurant.nombre"
        class="restaurant-image"
        (error)="onImageError($event)">
      <div *ngIf="!getRestaurantImage()" class="emoji">{{ restaurant.emoji || 'ğŸ½ï¸' }}</div>
    </div>
    <div class="badges">
      <span *ngIf="restaurant.nuevo" class="badge new">NUEVO</span>
      <span *ngIf="restaurant.promocion" class="badge promo">ğŸ PROMO</span>
    </div>
  </div>

  <div class="card-body">
    <div class="top">
      <h4 class="title">{{ restaurant.nombre }}</h4>
      <span class="status" [class.open]="restaurant.abierto">{{ restaurant.abierto ? 'Abierto' : 'Cerrado' }}</span>
    </div>
    <p class="types">{{ getFormattedTypes() }}</p>

    <div class="meta">
      <div class="rating-section">
        <div class="rating-main">
          <div class="stars">
            <span *ngFor="let i of [1,2,3,4,5]" class="star-icon">
              <span *ngIf="i <= getStarRating().full" class="star-full">â˜…</span>
              <span *ngIf="i === getStarRating().full + 1 && getStarRating().half" class="star-half">
                <span class="star-half-left">â˜…</span>
                <span class="star-half-right">â˜†</span>
              </span>
              <span *ngIf="i > getStarRating().full + (getStarRating().half ? 1 : 0)" class="star-empty">â˜†</span>
            </span>
          </div>
          <span class="rating-value">{{ getRatingAverage().toFixed(1) }}/5</span>
          <span class="reviews-count">({{ getTotalReviews() }} {{ getTotalReviews() === 1 ? 'reseÃ±a' : 'reseÃ±as' }})</span>
        </div>
        <div class="rating-breakdown" *ngIf="getTotalReviews() > 0">
          <div class="breakdown-item" *ngFor="let star of [5,4,3,2,1]">
            <span class="star-label">{{ star }}â˜…</span>
            <div class="breakdown-bar">
              <div class="breakdown-fill" [style.width.%]="getRatingPercentage(star)"></div>
            </div>
            <span class="breakdown-percent">{{ getRatingPercentage(star) }}%</span>
          </div>
        </div>
      </div>
      <div class="time">â± {{ restaurant.tiempoMin }}-{{ restaurant.tiempoMax }} min</div>
      <div class="delivery">ğŸšš {{ restaurant.costoEnvio === 0 ? 'Gratis' : '$' + restaurant.costoEnvio }}</div>
    </div>

    <div class="actions">
      <button class="btn" (click)="$event.stopPropagation(); addSampleDish()">Agregar</button>
    </div>
  </div>
</div>
